@startuml  DomainStory-ProductManagement-OrderInfo
!include https://raw.githubusercontent.com/johthor/DomainStory-PlantUML/main/domainStory.puml
!include ../SharedObjects.puml
!include OrderActors.puml
!include OrderObjects.puml
title Order Management - Apresentação do Pedido

Person(customer,"Cliente identificado", $color=#blue)
CustomerNonLogin(customerNotLogged,"Cliente não Identificado", $color=#OrangeRed)
Info(infoOrder,"Informações do Pedido", $color=#black)
System(mercadoPago,"Mercado Pago")
WebHook(webhook, "ConfirmaPagamento")


Boundary(orderManager,"Gestão de Pedidos") {
    System(orderSystem,"Sistema de Pedidos")    
    OrderBasket(orderBasket, "Pedido")            
}

rectangle infoOrderContext as "Informações do Pedido" {
        IdentityRegister(orderId, "ID do Pedido")    
        PaymentValue(paymentValue, "Valor de Pagamento")
        PaymentOrder(paymentOrder, "Qr PIX")
        Basket(preBasket,"Produtos do Pedido")
}

Boundary(paymentBroker, "Gestão de Pagamentos") {    
    System(paymentSystem,"broker de Pagamentos", $color=#green)
    PayOrder(pay, "Pagamento")
}

activity(_,orderSystem,apresenta, orderBasket, _,_,)
activity(_,orderBasket,visualiza, customer, _,_, <--)
activity(|,orderBasket,visualiza, customerNotLogged, _,_, -->)
activity(_,customer, faz, pay, no ,mercadoPago,-->)
activity(|,customerNotLogged, faz, pay, no ,mercadoPago,-->)
activity(_,mercadoPago, confirma, Info: state_FINISHED, no ,webhook,<--)
activity(_,webhook, atualiza, orderSystem, _,_,<--)
activity(_,orderSystem, fecha, orderBasket, envia ,preparacao,<--)

infoOrderContext -[#black]up-> infoOrder  
infoOrder -[#black]right-> orderBasket  


@enduml